## Article 7 - Setting Device Ownership by Primary Extension

This article covers restoring device ownership information using data stored in a CSV generated by the Python script in the previous article.

To do this we will use a Python script to submit SQL update queries to the CUCM API using device and owner information read from the CSV file.

- [Article 1 - Introduction and CUCM Licensing Overview.](https://jamesha100.github.io/cucm-license-management/page1)
- [Article 2 - Basic SQL Commands to Monitor and Update Licensing.](https://jamesha100.github.io/cucm-license-management/page2)
- [Article 3 - Using the CUCM AXL API.](https://jamesha100.github.io/cucm-license-management/page3)
- [Article 4 - Saving Existing Device Ownership Data.](https://jamesha100.github.io/cucm-license-management/page4)
- [Article 5 - Restoring Saved Device Ownership Data](https://jamesha100.github.io/cucm-license-management/page5)
- [Article 6 - Clearing Device Ownership Data](https://jamesha100.github.io/cucm-license-management/page6)
- Article 7 - Setting Device Ownership by Parimary Extension

### SQL Query Used to Set Device Ownership by Primary Extension

The SQL query we will use to set the device owner by primary extension is shown below.
```
run sql UPDATE device SET fkenduser = NULL  WHERE tkclass = "1" AND NOT (tkmodel = "72" OR tkmodel = "645")
```
This query will just once as there *where* conditions will match all user type phones.

### The Python Script
The Python script shown below will retrieve the data listed above and save it to a CSV file. The name of the CSV file includes date and time information so that new output files can be created without overwriting existing files.

The script comprises the following high level steps:

1. Load information needed to connect to the target CUCM server from an ini file.
2. Connect to the CUCM AXL API using the settings from the and set *fkenduser* value to NULL for all user type phones (not CTI ports or BAT template devices).

```

```
